<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="https://joeyzyz.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://joeyzyz.github.io/" rel="alternate" type="text/html" /><updated>2021-10-04T23:25:12+08:00</updated><id>https://joeyzyz.github.io/feed.xml</id><title type="html">blog</title><subtitle></subtitle><author><name>joey zhou</name></author><entry><title type="html">滑动窗口</title><link href="https://joeyzyz.github.io/2021/10/04/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" rel="alternate" type="text/html" title="滑动窗口" /><published>2021-10-04T00:00:00+08:00</published><updated>2021-10-04T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/10/04/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3</id><content type="html" xml:base="https://joeyzyz.github.io/2021/10/04/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/">&lt;h2 id=&quot;解题思路&quot;&gt;解题思路&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;以右指针作为驱动，拖着左指针向前走。右指针每次只移动一步，而左指针在内部 while 循环中每次可能移动多步&lt;/li&gt;
  &lt;li&gt;右指针是主动前移，探索未知的新区域；左指针是被迫移动，负责寻找满足题意的区间&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/traverse/sliding_window.py&quot;&gt; 代码 &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/max-consecutive-ones-iii/&quot;&gt;leetcode 1004&lt;/a&gt;
&lt;a href=&quot;https://leetcode-cn.com/problems/maximize-the-confusion-of-an-exam/&quot;&gt;leetcode 2024&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;</content><author><name>joey zhou</name></author><category term="leetcode" /><category term="Algorithm" /><summary type="html">解题思路 以右指针作为驱动，拖着左指针向前走。右指针每次只移动一步，而左指针在内部 while 循环中每次可能移动多步 右指针是主动前移，探索未知的新区域；左指针是被迫移动，负责寻找满足题意的区间</summary></entry><entry><title type="html">Hive 开窗函数</title><link href="https://joeyzyz.github.io/2021/09/05/Hive-%E5%BC%80%E7%AA%97%E5%87%BD%E6%95%B0/" rel="alternate" type="text/html" title="Hive 开窗函数" /><published>2021-09-05T00:00:00+08:00</published><updated>2021-09-05T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/09/05/Hive%20%E5%BC%80%E7%AA%97%E5%87%BD%E6%95%B0</id><content type="html" xml:base="https://joeyzyz.github.io/2021/09/05/Hive-%E5%BC%80%E7%AA%97%E5%87%BD%E6%95%B0/">&lt;h2 id=&quot;代码&quot;&gt;代码&lt;/h2&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://shzhangji.com/cnblogs/2017/09/05/hive-window-and-analytical-functions/&quot;&gt;Hive 窗口与分析型函数&lt;/a&gt;&lt;/p&gt;</content><author><name>joey zhou</name></author><category term="Todo" /><category term="Hive" /><category term="Big Data" /><summary type="html">代码</summary></entry><entry><title type="html">spark 数据倾斜及解决</title><link href="https://joeyzyz.github.io/2021/09/05/spark%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/" rel="alternate" type="text/html" title="spark 数据倾斜及解决" /><published>2021-09-05T00:00:00+08:00</published><updated>2021-09-05T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/09/05/spark%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C</id><content type="html" xml:base="https://joeyzyz.github.io/2021/09/05/spark%E6%95%B0%E6%8D%AE%E5%80%BE%E6%96%9C/">&lt;h2 id=&quot;问题表现&quot;&gt;问题表现&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;总共有1000个task，997个task都在1分钟之内执行完了，但是剩余两三个task却要一两个小时&lt;/li&gt;
  &lt;li&gt;原本能够正常执行的Spark作业，某天突然报出OOM（内存溢出）异常&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;问题原因&quot;&gt;问题原因&lt;/h2&gt;
&lt;p&gt;在进行shuffle的时候，必须将各个节点上相同的key拉取到某个节点上的一个task来进行处理，比如按照key进行聚合或join等操作。此时如果某个key对应的数据量特别大的话，就会发生数据倾斜。比如大部分key对应10条数据，但是个别key却对应了100万条数据，那么大部分task可能就只会分配到10条数据，然后1秒钟就运行完了；但是个别task可能分配到了100万数据，要运行一两个小时。因此，整个Spark作业的运行进度是由运行时间最长的那个task决定的。&lt;/p&gt;

&lt;h2 id=&quot;解决方法&quot;&gt;解决方法&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;适用场景&lt;/th&gt;
      &lt;th&gt;实现原理&lt;/th&gt;
      &lt;th&gt;方案优点&lt;/th&gt;
      &lt;th&gt;方案缺点&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;导致倾斜的key就少数几个&lt;/td&gt;
      &lt;td&gt;取数据量最多的key过滤掉即可&lt;/td&gt;
      &lt;td&gt;实现简单&lt;/td&gt;
      &lt;td&gt;适用场景不多&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;默认并行度较小（200）&lt;/td&gt;
      &lt;td&gt;提高shuffle操作的并行度,让每个task处理比原来更少的数据&lt;/td&gt;
      &lt;td&gt;实现简单&lt;/td&gt;
      &lt;td&gt;只是缓解&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;reduceByKey 和 groupByKey 操作&lt;/td&gt;
      &lt;td&gt;1. 先局部聚合：&lt;br /&gt; 给每个key都打上一个随机数, 再进行聚合操作 &lt;br /&gt; 2. 后全局聚合：&lt;br /&gt; 将各个key的前缀给去掉，再进行一次聚合操作&lt;/td&gt;
      &lt;td&gt;对于聚合类的shuffle操作导致的数据倾斜，效果是非常不错的&lt;/td&gt;
      &lt;td&gt;不适用与 join类的shuffle操作&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1. join 操作 &lt;br /&gt; 2. 其中一个表数据量较小&lt;/td&gt;
      &lt;td&gt;不使用join算子进行连接操作，而使用Broadcast变量与map类算子实现join操作&lt;/td&gt;
      &lt;td&gt;对join操作导致的数据倾斜，效果非常好&lt;/td&gt;
      &lt;td&gt;只适用于一个大表和一个小表的情况, 并不适合两个都是大表的情况&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1. join 操作 &lt;br /&gt; 2. 某几个key导致了倾斜&lt;/td&gt;
      &lt;td&gt;将少数几个key分拆成独立RDD，并附加随机前缀打散成n份去进行join 另一份数据（这份数据要先膨胀成n条数据）&lt;/td&gt;
      &lt;td&gt;在适用场景下效果较好&lt;/td&gt;
      &lt;td&gt;不适用于导致倾斜的key特别多的情况&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1. join 操作 &lt;br /&gt; 2. 大量key导致了倾斜&lt;/td&gt;
      &lt;td&gt;将所有key附加随机前缀打散成n份去进行join 另一份数据（这份数据要先膨胀成n条数据）&lt;/td&gt;
      &lt;td&gt;对join类型的数据倾斜基本都可以处理&lt;/td&gt;
      &lt;td&gt;需要对整个RDD进行扩容，对内存资源要求很高&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;代码&quot;&gt;代码&lt;/h2&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://tech.meituan.com/2016/05/12/spark-tuning-pro.html&quot;&gt;美团Spark性能优化指南&lt;/a&gt;&lt;/p&gt;</content><author><name>joey zhou</name></author><category term="Spark" /><category term="Big Data" /><summary type="html">问题表现 总共有1000个task，997个task都在1分钟之内执行完了，但是剩余两三个task却要一两个小时 原本能够正常执行的Spark作业，某天突然报出OOM（内存溢出）异常</summary></entry><entry><title type="html">01背包 &amp;amp; 完全背包</title><link href="https://joeyzyz.github.io/2021/08/29/01%E8%83%8C%E5%8C%85/" rel="alternate" type="text/html" title="01背包 &amp;amp; 完全背包" /><published>2021-08-29T00:00:00+08:00</published><updated>2021-08-29T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/29/01%E8%83%8C%E5%8C%85</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/29/01%E8%83%8C%E5%8C%85/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/dp/01-backpack.py&quot;&gt; 01背包代码 &lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/dp/multi-backpack.py&quot;&gt; 完全背包代码 &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;01 背包
&lt;a href=&quot;https://leetcode-cn.com/problems/minimize-the-difference-between-target-and-chosen-elements/&quot;&gt;leetcode 1981&lt;/a&gt;
&lt;a href=&quot;https://leetcode-cn.com/problems/partition-equal-subset-sum/&quot;&gt;leetcode 416&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;完全背包
&lt;a href=&quot;https://leetcode-cn.com/problems/coin-change/&quot;&gt;leetcode 322&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://raw.githubusercontent.com/tianyicui/pack/master/V2.pdf&quot;&gt; 背包九讲 &lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://edwardzcn.github.io/post/1590e320.html&quot;&gt; 01背包的常数优化 &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>joey zhou</name></author><category term="leetcode" /><category term="Algorithm" /><summary type="html">模板 01背包代码 完全背包代码</summary></entry><entry><title type="html">多任务学习在推荐系统中应用</title><link href="https://joeyzyz.github.io/2021/08/29/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%AD%A6%E4%B9%A0%E5%9C%A8%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%BA%94%E7%94%A8/" rel="alternate" type="text/html" title="多任务学习在推荐系统中应用" /><published>2021-08-29T00:00:00+08:00</published><updated>2021-08-29T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/29/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%AD%A6%E4%B9%A0%E5%9C%A8%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%BA%94%E7%94%A8</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/29/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E5%AD%A6%E4%B9%A0%E5%9C%A8%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%BA%94%E7%94%A8/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/55752344&quot;&gt;MMoE&lt;/a&gt;&lt;/p&gt;</content><author><name>joey zhou</name></author><category term="Todo" /><category term="LTR" /><category term="Recommendation" /><summary type="html">模板 代码</summary></entry><entry><title type="html">模型解释工具使用</title><link href="https://joeyzyz.github.io/2021/08/29/%E6%A8%A1%E5%9E%8B%E8%A7%A3%E9%87%8A%E6%80%A7%E5%B7%A5%E5%85%B7/" rel="alternate" type="text/html" title="模型解释工具使用" /><published>2021-08-29T00:00:00+08:00</published><updated>2021-08-29T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/29/%E6%A8%A1%E5%9E%8B%E8%A7%A3%E9%87%8A%E6%80%A7%E5%B7%A5%E5%85%B7</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/29/%E6%A8%A1%E5%9E%8B%E8%A7%A3%E9%87%8A%E6%80%A7%E5%B7%A5%E5%85%B7/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;常用工具&quot;&gt;常用工具&lt;/h2&gt;

&lt;h3 id=&quot;shap&quot;&gt;shap&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;单样本分析&lt;/li&gt;
  &lt;li&gt;两两交叉对预测值的影响&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;lime&quot;&gt;lime&lt;/h3&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/slundberg/shap&quot;&gt;shap 官方文档&lt;/a&gt;
&lt;a href=&quot;https://proceedings.neurips.cc/paper/2017/file/8a20a8621978632d76c43dfd28b67767-Paper.pdf&quot;&gt;shap paper&lt;/a&gt;
&lt;a href=&quot;https://zhuanlan.zhihu.com/p/149745182&quot;&gt;shap value 介绍&lt;/a&gt;&lt;/p&gt;</content><author><name>joey zhou</name></author><category term="Todo" /><category term="Model Tools" /><summary type="html">模板 代码</summary></entry><entry><title type="html">状态压缩 DP</title><link href="https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E5%8E%8BDP/" rel="alternate" type="text/html" title="状态压缩 DP" /><published>2021-08-29T00:00:00+08:00</published><updated>2021-08-29T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E5%8E%8BDP</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E5%8E%8BDP/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/dp/state_compress_dp.py&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;技巧&quot;&gt;技巧&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;位运算常用写法
    &lt;ul&gt;
      &lt;li&gt;判断第 i 位是否为 1: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(mask &amp;gt;&amp;gt; i) &amp;amp; 1&lt;/code&gt; 或 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mask &amp;amp; (1 &amp;lt;&amp;lt; i)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;将第 i 位取反（1 变成 0，0 变成 1）: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mask ^ (1 &amp;lt;&amp;lt; i)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;将第 i 位变成 0: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mask &amp;amp; ~(1 &amp;lt;&amp;lt; i)&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;统计二进制 1 的个数：&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bin(mask).count(&quot;1&quot;)&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/minimum-number-of-work-sessions-to-finish-the-tasks/&quot;&gt;leetcode 2327&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>joey zhou</name></author><category term="leetcode" /><category term="Algorithm" /><summary type="html">模板 代码</summary></entry><entry><title type="html">有限状态机 DFA</title><link href="https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E6%80%81%E6%9C%BA/" rel="alternate" type="text/html" title="有限状态机 DFA" /><published>2021-08-29T00:00:00+08:00</published><updated>2021-08-29T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E6%80%81%E6%9C%BA</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/29/%E7%8A%B6%E6%80%81%E6%9C%BA/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/biao-shi-shu-zhi-de-zi-fu-chuan-lcof/&quot;&gt;leetcode 表示数值的字符串&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;参考资料&quot;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://chenyuxiaodhr.github.io/zh-CN/Game-Development/Finite-State-Machine-in-Game-Development/&quot;&gt;游戏开发之状态机的实现与优化&lt;/a&gt;&lt;/p&gt;</content><author><name>joey zhou</name></author><category term="Todo" /><category term="leetcode" /><category term="Algorithm" /><summary type="html">模板 代码</summary></entry><entry><title type="html">BFS</title><link href="https://joeyzyz.github.io/2021/08/22/BFS/" rel="alternate" type="text/html" title="BFS" /><published>2021-08-22T00:00:00+08:00</published><updated>2021-08-22T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/22/BFS</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/22/BFS/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/traverse/BFS.py&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;</content><author><name>joey zhou</name></author><category term="leetcode" /><category term="Algorithm" /><summary type="html">模板 代码</summary></entry><entry><title type="html">DFS &amp;amp; 回溯</title><link href="https://joeyzyz.github.io/2021/08/22/DFS-%E5%9B%9E%E6%BA%AF/" rel="alternate" type="text/html" title="DFS &amp;amp; 回溯" /><published>2021-08-22T00:00:00+08:00</published><updated>2021-08-22T00:00:00+08:00</updated><id>https://joeyzyz.github.io/2021/08/22/DFS-%E5%9B%9E%E6%BA%AF</id><content type="html" xml:base="https://joeyzyz.github.io/2021/08/22/DFS-%E5%9B%9E%E6%BA%AF/">&lt;h2 id=&quot;模板&quot;&gt;模板&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/joeyzyz/leetcode-template/blob/main/traverse/DFS.py&quot;&gt;代码&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;技巧&quot;&gt;技巧&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;剪枝&lt;/li&gt;
  &lt;li&gt;记忆化搜索&lt;/li&gt;
  &lt;li&gt;遍历的对象选择：大多数时候是集合中的一个元素，有的时候是以集合中的多个元素为一个遍历对象&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;典型题目&quot;&gt;典型题目&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/maximum-compatibility-score-sum/&quot;&gt;leetcode 1947&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/minimum-number-of-work-sessions-to-finish-the-tasks/&quot;&gt;leetcode 2347&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>joey zhou</name></author><category term="leetcode" /><category term="Algorithm" /><summary type="html">模板 代码</summary></entry></feed>